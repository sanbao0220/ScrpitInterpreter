## 设计需求说明
描述：领域特定语言（DSL）是实现定制化业务流程的核心方法。本作业要求设计一个能够描述特定领域的智能客服机器人的应答逻辑的脚本语言，并实现其解释器。针对来自用户的自然语言，能够调用大型语言模型（LLM）API实现意图识别以驱动脚本的解释执行。本作业旨在评估学生在现代软件开发环境中，融合传统规则引擎与前沿AI技术、进行系统设计、模块化以及严谨验证的能力。

程序功能基本要求：
1.     脚本语言的语法可以自由定义，只要语义上满足描述客服机器人自动应答逻辑的要求。

2.     应该给出几种针对不同业务场景的脚本范例，对不同脚本范例解释器执行之后会有不同的行为表现。

3.     选用一种开放API的大语言模型，调用其API对用户的非结构化输入进行意图识别。

4.     程序输入输出形式不限，可以简化为纯命令行界面。



开发环境要求：

1.     程序设计语言没有限制

2.     可以使用类似yacc，lex的工具

3.     可以使用大模型辅助开发（如果使用，需要记录开发过程信息在文档中体现，例如，编程过程中，给LLM提的要求，使用的提示词；几轮对话，如果轮数很多，可以简化过程，只说明前几轮和最后几轮的LLM输出结果；如模块划分，接口形式，每个类的定义，需要有明确的要求。LLM的回复是什么，你做了哪些修改。原则是：使用LLM的地方要详细说明使用过程和对LLM输出结果的利用情况。这些内容要体现在文档中。）

4.     必须使用GIT进行版本管理

## 文本脚本
Step welcome
Speak $name + "您好，请问有什么可以帮您?"
Listen 5, 20
Branch "投诉", complainProc
Branch "账单", billProc
Silence silenceProc
Default defaultProc

Step complainProc
Speak "您的意见是我们改进工作的动力，请问您还有什么补充?"
Listen 5, 50
Default thanks

Step thanks
Speak "感谢您的来电，再见"
Exit

Step billProc
Speak "您的本月账单是" + $amount + "元，感谢您的来电，再见"
Exit

Step silenceProc
Speak "听不清，请您大声一点可以吗"
Listen 5, 20
Branch "投诉", complainProc
Branch "账单", billProc
Silence silenceProc
Default defaultProc

Step defaultProc

## 文本脚本行为

Step: 完整表示一个步骤的所有行为

Speak: 计算表达式合成一段文字。调用媒体服务器进行语音合成并播放

Listen: 调用媒体服务器对客户说的话录音，并进行语音识别。语音识别的结果调用"自然语言分析服务"分析客户的意愿

Branch: 对客户的意愿进行分支处理，不同的意愿，跳转到不同的Step

Silence: 如果用户不说话，应该跳转到哪个Step

Default: 如果客户意愿没有相应匹配，应该跳转到哪个Step

Exit: 结束对话

## json脚本
{
  "metadata": {
    "name": "客服对话脚本（完整版）",
    "version": "2.0",
    "description": "包含退出机制和意图识别失败处理"
  },
  "steps": {
    "welcome": {
      "name": "welcome",
      "actions": {
        "speak": "欢迎使用客服系统，请问我有什么能够帮助您的？您可以说投诉、账单查询、转人工服务，或者直接说退出。"
        ,"listen": "5,20"
      },
      "branch": {
        "投诉": "complainProc",
        "账单": "billProc",
        "退出": "thanks",
        "转人工": "humanService",
        "沉默": "silenceProc"
      }
    },
     "complainProc":
     {
       "name": "",
       "actions": [],
       "branch": {

       }
     }
  }

}

## 我的项目是为文本脚本设置一个脚本解释器，现在我只完成了json脚本到astree构建，请你帮我完成一个从文本脚本到对应Json脚本格式的解释器

学习git相关版本管理
先完成git操作
接下来设计一个京东客服的文本脚本，然后对应的数据库架构
完成action操作
进行测试

重新构造语法分析树，需要新设计数据缓冲区方便进行读取，需要将文件进行整合，让架构更加清晰

